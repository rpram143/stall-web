import{h as a,b as l,a as u,l as m,u as g,i as y}from"./db-Ddrb56FG.js";let r=[],o=null;async function p(){const e=await u();if(!e||!e.is_admin){alert("Access denied. Admin only."),window.location.href="index.html";return}await s(),f()}async function s(){const e=document.getElementById("admin-products-list");try{if(r=await l(),r.length===0){e.innerHTML='<tr><td colspan="5" class="loading">No products yet. Add your first sweet!</td></tr>';return}e.innerHTML=r.map(t=>`
      <tr>
        <td><img src="${t.image_url}" alt="${t.name}"></td>
        <td>${t.name}</td>
        <td>${t.description}</td>
        <td>â‚¹${t.price}</td>
        <td>
          <button class="action-btn edit-btn" onclick="window.editProduct('${t.id}')">Edit</button>
          <button class="action-btn delete-btn" onclick="window.deleteProductConfirm('${t.id}')">Delete</button>
        </td>
      </tr>
    `).join("")}catch(t){console.error("Error loading products:",t),e.innerHTML='<tr><td colspan="5" class="loading">Error loading products.</td></tr>'}}function f(){const e=document.getElementById("add-product-btn"),t=document.getElementById("product-form-modal"),n=document.querySelector(".close"),d=document.getElementById("product-form"),c=document.getElementById("admin-logout-btn");e.addEventListener("click",()=>{o=null,document.getElementById("form-title").textContent="Add New Sweet",d.reset(),document.getElementById("form-message").textContent="",t.style.display="block"}),n.addEventListener("click",()=>{t.style.display="none"}),window.addEventListener("click",i=>{i.target===t&&(t.style.display="none")}),d.addEventListener("submit",E),c.addEventListener("click",i=>{i.preventDefault(),m(),window.location.href="index.html"})}async function E(e){e.preventDefault();const t=document.getElementById("form-message"),n=document.getElementById("product-form-modal"),d={name:document.getElementById("product-name").value,description:document.getElementById("product-description").value,price:parseFloat(document.getElementById("product-price").value),image_url:document.getElementById("product-image").value};try{t.textContent=o?"Updating product...":"Adding product...",t.className="message",o?(await g(o,d),t.textContent="Product updated successfully!"):(await y(d),t.textContent="Product added successfully!"),t.className="message success",setTimeout(()=>{n.style.display="none",s()},1e3)}catch(c){t.textContent=c.message,t.className="message error"}}window.editProduct=function(e){const t=r.find(n=>n.id===e);t&&(o=e,document.getElementById("form-title").textContent="Edit Sweet",document.getElementById("product-name").value=t.name,document.getElementById("product-description").value=t.description,document.getElementById("product-price").value=t.price,document.getElementById("product-image").value=t.image_url,document.getElementById("form-message").textContent="",document.getElementById("product-form-modal").style.display="block")};window.deleteProductConfirm=async function(e){if(confirm("Are you sure you want to delete this sweet?"))try{await a(e),await s()}catch(t){alert("Error deleting product: "+t.message)}};p();
